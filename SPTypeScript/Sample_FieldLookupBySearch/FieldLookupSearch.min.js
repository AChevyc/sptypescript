var _;(function(){function n(){CSR.override(10003).fieldNew("Master",t).fieldEdit("Master",t).register()}function t(n){function v(){u=document.getElementById(f),u.addEventListener("blur",function(){return i.CloseAutoFill(null)},!1),SP.SOD.executeFunc("autofill.js",null,function(){i=new SPClientAutoFill(f,o,y),i.AutoFillMinTextLength=2,i.VisibleItemCount=15,i.AutoFillTimeout=500}),SP.SOD.executeFunc("sp.search.js",null,null)}function y(n){var c=n.value,r,e,o;i.PopulateAutoFill([b("Please wait...")],h);var u=Microsoft.SharePoint.Client.Search.Query,f=SP.ClientContext.get_current(),t=new u.KeywordQuery(f);t.set_rowLimit(i.VisibleItemCount),t.set_queryText("contentclass:STS_ListItem ListID:{"+l.LookupListId+"} "+c),r=t.get_selectProperties(),r.clear(),r.add("Title"),r.add("ListItemId"),e=new u.SearchExecutor(f),o=e.executeQuery(t),f.executeQueryAsync(function(){var e=new u.ResultTableCollection,t;e.initPropertiesFromJson(o.get_value());var f=e.get_item(0),r=f.get_resultRows(),n=[];for(t=0;t<r.length;t++)n.push(p(r[t].Title,parseInt(r[t].ListItemId,10)));n.push(w()),f.get_totalRows()==0?n.push(s("No results. Please refine your query.")):n.push(s("Showing "+r.length+" of"+f.get_totalRows()+" items!")),i.PopulateAutoFill(n,h)},function(n,t){alert(t.get_message()),i.CloseAutoFill(null)})}function s(n){var t={};return t[SPClientAutoFill.DisplayTextProperty]=n,t[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Footer,t}function p(n,t){var i={};return i[SPClientAutoFill.KeyProperty]=t,i[SPClientAutoFill.DisplayTextProperty]=n,i[SPClientAutoFill.TitleTextProperty]=n,i[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Option,i}function w(){var n={};return n[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Separator,n}function b(n){var t={};return t[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Loading,t[SPClientAutoFill.DisplayTextProperty]=n,t}function h(n,t){var i=document.getElementById(n);i.value=t[SPClientAutoFill.DisplayTextProperty],r.LookupId=t[SPClientAutoFill.KeyProperty],r.LookupValue=t[SPClientAutoFill.DisplayTextProperty],k()}function k(){t.updateControlValue(t.fieldName,c())}function c(){return r.LookupId==0||r.LookupValue==""?"":r.LookupId+";#"+r.LookupValue}function d(){var n=[];return n.push('<div dir="'+STSHtmlEncode(t.fieldSchema.Direction)+'" style="position: relative;">'),n.push('<input type="text" id="'+STSHtmlEncode(f)+'" value="'+STSHtmlEncode(r.LookupValue)+'" title="'+STSHtmlEncode(t.fieldSchema.Title)+'"/>'),n.push("<div class='sp-peoplepicker-autoFillContainer' id='"+STSHtmlEncode(o)+"'><\/div>"),n.push("<\/div>"),n.join("")}var t;if(n==null||(t=SPClientTemplates.Utility.GetFormContextForCurrentField(n),t==null||t.fieldSchema==null))return"";var l=t.fieldSchema,i,u,f=t.fieldName+"_"+t.fieldSchema.Id+"_$TextField",o=t.fieldName+"_"+t.fieldSchema.Id+"_$AutoFill",e=t.fieldValue!=null?t.fieldValue:"",r=SPClientTemplates.Utility.ParseLookupValue(e),a=r.LookupId==0;return a&&(e=""),t.registerInitCallback(t.fieldName,v),t.registerFocusCallback(t.fieldName,function(){u!=null&&u.focus()}),t.registerValidationErrorCallback(t.fieldName,function(n){SPFormControl_AppendValidationErrorMessage(f,n)}),t.registerGetValueCallback(t.fieldName,c),t.updateControlValue(t.fieldName,e),d()}SP.SOD.executeOrDelayUntilScriptLoaded(n,"typescripttemplates.ts"),SP.SOD.executeOrDelayUntilScriptLoaded(function(){RegisterModuleInit(SPClientTemplates.Utility.ReplaceUrlTokens("~site/Sample_FieldLookupBySearch/FieldLookupSearch.js"),n)},"sp.js")})(_||(_={}))