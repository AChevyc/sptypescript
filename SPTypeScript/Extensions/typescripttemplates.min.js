var CSR;(function(n){function e(n,t){function r(n){var t,r,u;(n.ControlMode==SPClientTemplates.ClientControlMode.EditForm||n.ControlMode==SPClientTemplates.ClientControlMode.NewForm)&&(t=n.ListSchema.Field[0],n.FormContextHook||(n.FormContextHook={},r=n.FormContext.registerGetValueCallback,n.FormContext.registerGetValueCallback=function(t,i){n.FormContextHook[t].getValue=i;r(t,i)},u=n.FormContext.updateControlValue,n.FormContext.updateControlValue=function(t,r){var e,o,f;for(u(t,r),e=i(n.FormContextHook,t),e.lastValue=r,o=n.FormContextHook[t].updatedValueCallbacks,f=0;f<o.length;f++)o[f](r,e.fieldSchema)}),i(n.FormContextHook,t.Name).fieldSchema=t)}return new u(n,t).onPreRender(r)}function o(n,t){if(n.ControlMode==SPClientTemplates.ClientControlMode.EditForm||n.ControlMode==SPClientTemplates.ClientControlMode.NewForm){var i=n;if(i.FormContextHook&&i.FormContextHook[t]&&i.FormContextHook[t].getValue)return i.FormContextHook[t].getValue()}return null}function s(n,t){if(n.ControlMode==SPClientTemplates.ClientControlMode.EditForm||n.ControlMode==SPClientTemplates.ClientControlMode.NewForm){var i=n;if(i.FormContextHook&&i.FormContextHook[t])return i.FormContextHook[t].fieldSchema}return null}function h(n,t,r){var f,u,e;(n.ControlMode==SPClientTemplates.ClientControlMode.EditForm||n.ControlMode==SPClientTemplates.ClientControlMode.NewForm)&&(f=n,f.FormContextHook&&(u=i(f.FormContextHook,t),e=u.updatedValueCallbacks,e.indexOf(r)==-1&&(e.push(r),u.lastValue&&r(u.lastValue,u.fieldSchema))))}function c(n,t,r){var u,f,e;(n.ControlMode==SPClientTemplates.ClientControlMode.EditForm||n.ControlMode==SPClientTemplates.ClientControlMode.NewForm)&&(u=n,u.FormContextHook&&(f=i(u.FormContextHook,t).updatedValueCallbacks,e=f.indexOf(r),e!=-1&&f.splice(e,1)))}function l(n){var t=n.Name+"_"+n.Id+"_$"+n.FieldType+"Field";return $get(t)}function r(n,t){var i={ListSchema:{Field:[n]},FieldControlModes:{}},r;return i.FieldControlModes[n.Name]=t,r=SPClientTemplates.TemplateManager.GetTemplates(i),r.Fields[n.Name]}function i(n,t){return n[t]=n[t]||{updatedValueCallbacks:[]}}var u,t,f;n.override=e;n.getFieldValue=o;n.getFieldSchema=s;n.addUpdatedValueCallback=h;n.removeUpdatedValueCallback=c;n.getControl=l;n.getFieldTemplate=r;u=function(){function i(n,t){this.ListTemplateType=n;this.BaseViewID=t;this.Templates={Fields:{}};this.OnPreRender=[];this.OnPostRender=[];this.IsRegistered=!1}return i.prototype.view=function(n){return this.Templates.View=n,this},i.prototype.item=function(n){return this.Templates.Item=n,this},i.prototype.header=function(n){return this.Templates.Header=n,this},i.prototype.body=function(n){return this.Templates.Body=n,this},i.prototype.footer=function(n){return this.Templates.Footer=n,this},i.prototype.fieldView=function(n,t){return this.Templates.Fields[n]=this.Templates.Fields[n]||{},this.Templates.Fields[n].View=t,this},i.prototype.fieldDisplay=function(n,t){return this.Templates.Fields[n]=this.Templates.Fields[n]||{},this.Templates.Fields[n].DisplayForm=t,this},i.prototype.fieldNew=function(n,t){return this.Templates.Fields[n]=this.Templates.Fields[n]||{},this.Templates.Fields[n].NewForm=t,this},i.prototype.fieldEdit=function(n,t){return this.Templates.Fields[n]=this.Templates.Fields[n]||{},this.Templates.Fields[n].EditForm=t,this},i.prototype.template=function(n,t){return this.Templates[n]=t,this},i.prototype.fieldTemplate=function(n,t,i){return this.Templates.Fields[n]=this.Templates.Fields[n]||{},this.Templates.Fields[n][t]=i,this},i.prototype.onPreRender=function(){for(var t,i=[],n=0;n<arguments.length-0;n++)i[n]=arguments[n+0];for(t=0;t<i.length;t++)this.OnPreRender.push(i[t]);return this},i.prototype.onPostRender=function(){for(var t,i=[],n=0;n<arguments.length-0;n++)i[n]=arguments[n+0];for(t=0;t<i.length;t++)this.OnPostRender.push(i[t]);return this},i.prototype.makeReadOnly=function(n){this.onPreRender(function(t){var s,f,e,i,h,u,o,c;if(t.ControlMode!=SPClientTemplates.ClientControlMode.Invalid&&t.ControlMode!=SPClientTemplates.ClientControlMode.DisplayForm)if(t.ControlMode==SPClientTemplates.ClientControlMode.View){for(s=t,e=s.ListSchema.Field,i=0;i<e.length;i++)e[i].Name===n&&(f=e[i]);f&&(s.inGridMode?f.ReadOnlyField=!0:(h=f,h.ReadOnly="TRUE"))}else u=t,o=u.ListSchema.Field[0],o.Name===n&&(o.ReadOnlyField=!0,c=r(o,SPClientTemplates.ClientControlMode.DisplayForm),u.Templates.Fields[n]=c,u.FormContext.registerGetValueCallback(n,function(){return u.ListData.Items[0][n]}))});return this},i.prototype.makeHidden=function(n){this.onPreRender(function(t){var i,u,f,r,e,s,h;if(t.ControlMode!=SPClientTemplates.ClientControlMode.Invalid)if(t.ControlMode==SPClientTemplates.ClientControlMode.View){for(i=t,f=i.ListSchema.Field,r=0;r<f.length;r++)f[r].Name===n&&(u=f[r]);u&&(i.inGridMode?u.Hidden=!0:i.ListSchema.Field.splice(i.ListSchema.Field.indexOf(u),1))}else if(e=t,s=e.ListSchema.Field[0],s.Name===n){s.Hidden=!0;for(var c=e.FormUniqueId+e.FormContext.listAttributes.Id+n,l=$get(c),o=l;o.tagName.toUpperCase()!=="TR";)o=o.parentElement;h=o;h.style.display="none"}});return this},i.prototype.cascadeLookup=function(t,i){function r(t){function tt(){u=document.getElementById(l);u!=null&&AddEvtHandler(u,"onchange",w);SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){rt(y);g()})}function it(){var n='<span dir="'+STSHtmlEncode(r.fieldSchema.Direction)+'">';return n+='<select id="'+STSHtmlEncode(l)+'" title="'+STSHtmlEncode(r.fieldSchema.Title)+'">',n+"<\/select><br/><\/span>"}function w(){h&&u!=null&&(r.updateControlValue(r.fieldName,b()),e=parseInt(u.value,10))}function b(){return u==null?"":u.value=="0"||u.value==""?"":u.value+";#"+u.options[u.selectedIndex].text}function k(n){return n.substring(1,n.length-1)}function d(n,t,i,r,u){var l=!!i,s;if(l&&(s=SPClientTemplates.Utility.ParseLookupValue(t),r.length==1&&r[0]=="Value"?(t=s.LookupValue,r.shift()):t=s.LookupId.toString()),r.length==0)o[n]=t,u();else{var e=SP.ClientContext.get_current(),a=e.get_web(),h=a.get_lists().getById(i),c=h.getItemById(parseInt(t,10)),f=h.get_fields().getByInternalNameOrTitle(r.shift());e.load(c);e.load(f);e.executeQueryAsync(function(){var t=c.get_item(f.get_internalName()),o;f.get_typeAsString()=="Lookup"&&(f=e.castTo(f,SP.FieldLookup),o=t,t=o.get_lookupId()+";#"+o.get_lookupValue(),i=f.get_lookupList());d(n,t,i,r,u)},function(n,t){console.log(t.get_message())})}}function rt(i){i.forEach(function(i){var r=i.split("."),u=r.shift();n.addUpdatedValueCallback(t,u,function(n,t){d(i,n,t.LookupListId,r.slice(0),g)})})}function g(){var t;h=!1;var n=SP.ClientContext.get_current(),f=n.get_web(),s=c.LookupListId,l=f.get_lists().getById(s),r=new SP.CamlQuery,a=i.replace(v,function(n){var t=k(n);return o[t]?o[t]:""});for(r.set_viewXml("<View><Query><Where>"+a+'<\/Where><\/Query> <ViewFields><FieldRef Name="ID" /><FieldRef Name="Title"/><\/ViewFields><\/View>'),t=l.getItems(r),n.load(t);u.options.length;)u.options.remove(0);n.executeQueryAsync(function(){var r,n;for(c.Required||(r=new Option(Strings.STS.L_LookupFieldNoneOption,"0",e==0,e==0),u.options.add(r)),n=t.getEnumerator();n.moveNext();){var i=n.get_current(),f=i.get_id(),o=new Option(i.get_item("Title"),i.get_item("ID"),e==f,e==f);u.options.add(o)}h=!0;w()},function(n,t){console.log(t.get_message())})}for(var v=/\{[^\}]+\}/g,y=[],p,o,u,r,c,s;p=v.exec(i);)y.push(k(p[0]));if((o={},t==null)||(r=SPClientTemplates.Utility.GetFormContextForCurrentField(t),r==null||r.fieldSchema==null))return"";c=r.fieldSchema;s=new SPClientForms.ClientValidation.ValidatorSet;s.RegisterValidator(new f(function(){return h},"Wait until lookup values loaded and try again"));r.fieldSchema.Required&&s.RegisterValidator(new SPClientForms.ClientValidation.RequiredValidator);r.registerClientValidator(r.fieldName,s);var l=r.fieldName+"_"+r.fieldSchema.Id+"_$LookupField",a=r.fieldValue!=null?r.fieldValue:"",e=SPClientTemplates.Utility.ParseLookupValue(a).LookupId,nt=e==0,h=!1;return nt&&(a=""),r.registerInitCallback(r.fieldName,tt),r.registerFocusCallback(r.fieldName,function(){u!=null&&u.focus()}),r.registerValidationErrorCallback(r.fieldName,function(n){SPFormControl_AppendValidationErrorMessage(l,n)}),r.registerGetValueCallback(r.fieldName,b),r.updateControlValue(r.fieldName,a),it()}return this.fieldEdit(t,r).fieldNew(t,r)},i.prototype.computedValue=function(t,i){for(var f,e=this,u=[],r=0;r<arguments.length-2;r++)u[r]=arguments[r+2];f={};return this.onPostRender(function(r){var o,s;(r.ControlMode==SPClientTemplates.ClientControlMode.EditForm||r.ControlMode==SPClientTemplates.ClientControlMode.NewForm)&&(o=r.ListSchema.Field[0],o.Name==t&&(s=n.getControl(o),u.forEach(function(t){n.addUpdatedValueCallback(r,t,function(n){f[t]=n;s.value=i.apply(e,u.map(function(n){return f[n]||""}))})})))})},i.prototype.setInitialValue=function(n,t,i){return t||!i?this.onPreRender(function(i){var r=i.ListSchema.Field[0];r.Name===n&&(i.ListData.Items[0][n]=t)}):this},i.prototype.autofill=function(n,t){function i(n){function s(){r=document.getElementById(u);SP.SOD.executeFunc("autofill.js","SPClientAutoFill",function(){f=new SPClientAutoFill(u,e,function(){return o()});var o=t({renderContext:n,fieldContext:i,autofill:f,control:r})})}function h(){var n=[];return n.push('<div dir="'+STSHtmlEncode(i.fieldSchema.Direction)+'" style="position: relative;">'),n.push('<input type="text" id="'+STSHtmlEncode(u)+'" title="'+STSHtmlEncode(i.fieldSchema.Title)+'"/>'),n.push("<div class='sp-peoplepicker-autoFillContainer' id='"+STSHtmlEncode(e)+"'><\/div>"),n.push("<\/div>"),n.join("")}var i;if(n==null||(i=SPClientTemplates.Utility.GetFormContextForCurrentField(n),i==null||i.fieldSchema==null))return"";var f,r,u=i.fieldName+"_"+i.fieldSchema.Id+"_$"+i.fieldSchema.Type+"Field",e=i.fieldName+"_"+i.fieldSchema.Id+"_$AutoFill",o=new SPClientForms.ClientValidation.ValidatorSet;return i.fieldSchema.Required&&o.RegisterValidator(new SPClientForms.ClientValidation.RequiredValidator),i.registerClientValidator(i.fieldName,o),i.registerInitCallback(i.fieldName,s),i.registerFocusCallback(i.fieldName,function(){r!=null&&r.focus()}),i.registerValidationErrorCallback(i.fieldName,function(n){SPFormControl_AppendValidationErrorMessage(u,n)}),i.registerGetValueCallback(i.fieldName,function(){return i.fieldValue}),i.updateControlValue(i.fieldName,i.fieldValue),h()}return this.fieldNew(n,i).fieldEdit(n,i)},i.prototype.seachLookup=function(n){return this.autofill(n,function(i){function e(n,t){var u=i.control;u.value=t[SPClientAutoFill.DisplayTextProperty];f.LookupId=t[SPClientAutoFill.KeyProperty];f.LookupValue=t[SPClientAutoFill.DisplayTextProperty];r.fieldValue=t[SPClientAutoFill.KeyProperty]+";#"+t[SPClientAutoFill.TitleTextProperty];r.updateControlValue(r.fieldSchema.Name,r.fieldValue)}var r=i.fieldContext,o=r.fieldSchema,u;if(r.fieldSchema.Type!="Lookup")return null;var s=r.fieldValue!=null?r.fieldValue:"",f=SPClientTemplates.Utility.ParseLookupValue(s),h=f.LookupId==0;return i.control.value=f.LookupValue,$addHandler(i.control,"blur",function(){i.control.value==""&&(r.fieldValue="",r.updateControlValue(n,r.fieldValue))}),h&&(r.fieldValue=""),u=i.autofill,u.AutoFillMinTextLength=2,u.VisibleItemCount=15,u.AutoFillTimeout=500,function(){var n=i.control.value;u.PopulateAutoFill([t.buildLoadingItem("Please wait...")],e);SP.SOD.executeFunc("sp.search.js","Microsoft.SharePoint.Client.Search.Query",function(){var f=Microsoft.SharePoint.Client.Search.Query,s=SP.ClientContext.get_current(),i=new f.KeywordQuery(s),r,h,c;i.set_rowLimit(u.VisibleItemCount);i.set_queryText("contentclass:STS_ListItem ListID:{"+o.LookupListId+"} "+n);r=i.get_selectProperties();r.clear();r.add("Title");r.add("ListItemId");h=new f.SearchExecutor(s);c=h.executeQuery(i);s.executeQueryAsync(function(){var s=new f.ResultTableCollection,i;s.initPropertiesFromJson(c.get_value());var o=s.get_item(0),r=o.get_resultRows(),n=[];for(i=0;i<r.length;i++)n.push(t.buildOptionItem(parseInt(r[i].ListItemId,10),r[i].Title));n.push(t.buildSeparatorItem());o.get_totalRows()==0?n.push(t.buildFooterItem("No results. Please refine your query.")):n.push(t.buildFooterItem("Showing "+r.length+" of"+o.get_totalRows()+" items!"));u.PopulateAutoFill(n,e)},function(n,i){u.PopulateAutoFill([t.buildFooterItem("Error executing query/ See log for details.")],e);console.log(i.get_message())})})}})},i.prototype.register=function(){this.IsRegistered||(SPClientTemplates.TemplateManager.RegisterTemplateOverrides(this),this.IsRegistered=!0)},i}();t=function(){function n(){}return n.buildFooterItem=function(n){var t={};return t[SPClientAutoFill.DisplayTextProperty]=n,t[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Footer,t},n.buildOptionItem=function(n,t,i,r){var u={};return u[SPClientAutoFill.KeyProperty]=n,u[SPClientAutoFill.DisplayTextProperty]=i||t,u[SPClientAutoFill.SubDisplayTextProperty]=r,u[SPClientAutoFill.TitleTextProperty]=t,u[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Option,u},n.buildSeparatorItem=function(){var n={};return n[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Separator,n},n.buildLoadingItem=function(n){var t={};return t[SPClientAutoFill.MenuOptionTypeProperty]=SPClientAutoFill.MenuOptionType.Loading,t[SPClientAutoFill.DisplayTextProperty]=n,t},n}();n.AutoFillOptionBuilder=t;f=function(){function n(n,t){this.valueGetter=n;this.validationMessage=t}return n.prototype.Validate=function(){return new SPClientForms.ClientValidation.ValidationResult(!this.valueGetter(),this.validationMessage)},n}()})(CSR||(CSR={}));typeof SP=="object"&&SP&&typeof SP.SOD=="object"&&SP.SOD&&SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("typescripttemplates.ts");
/*
//# sourceMappingURL=typescripttemplates.min.js.map
*/