var _;(function(){function u(){r=SP.Taxonomy.TaxonomySession.getTaxonomySession(n);t=r.getDefaultSiteCollectionTermStore();n.load(r);n.load(t);n.executeQueryAsync(o,a)}function o(){i=t.get_groups();n.load(i);n.executeQueryAsync(s,l)}function s(){$("#report").children().remove();for(var n=i.getEnumerator();n.moveNext();)(function(){var r=n.get_current(),t=document.createElement("div"),i;t.setAttribute("style","float:none;cursor:pointer");i=r.get_id();t.setAttribute("id",i.toString());$(t).click(function(){return h(i)});t.appendChild(document.createTextNode(r.get_name()));$("#report").append(t)})()}function h(t){for(var r=document.getElementById(t.toString()),u,f;r.childNodes.length>1;)r.removeChild(r.lastChild);u=i.getById(t);n.load(u);n.executeQueryPromise().then(function(){return f=u.get_termSets(),n.load(f),n.executeQueryPromise()}).then(function(){for(var n=f.getEnumerator();n.moveNext();)(function(){var f=n.get_current(),i=document.createElement("div"),u;i.appendChild(document.createTextNode(" + "+f.get_name()));i.setAttribute("style","float:none;cursor:pointer;");u=f.get_id();i.setAttribute("id",u.toString());$(i).click(function(n){return c(n,t,u)});r.appendChild(i)})()}).fail(function(){return r.appendChild(document.createTextNode("An error occurred in loading the term sets for this group"))})}function c(t,r,u){var f,e,o,s,h;for(t.cancelBubble=!0,f=document.getElementById(u.toString());f.childNodes.length>1;)f.removeChild(f.lastChild);e=i.getById(r);n.load(e);n.executeQueryPromise().then(function(){return o=e.get_termSets(),n.load(o),n.executeQueryPromise()}).then(function(){return s=o.getById(u),n.load(s),n.executeQueryPromise()}).then(function(){return h=s.get_terms(),n.load(h),n.executeQueryPromise()}).then(function(){for(var t=h.getEnumerator(),i,n;t.moveNext();)i=t.get_current(),n=document.createElement("div"),n.appendChild(document.createTextNode("    - "+i.get_name())),n.setAttribute("style","float:none;margin-left:10px;"),f.appendChild(n)}).fail(function(){return f.appendChild(document.createTextNode("An error occurred when trying to retrieve terms in this term set"))})}function l(n,t){$("#report").children().remove();$("#report").append("Failed to retrieve groups. Error:"+t.get_message())}function a(n,t){$("#report").children().remove();$("#report").append("Failed to get session. Error: "+t.get_message())}function v(){r=SP.Taxonomy.TaxonomySession.getTaxonomySession(n);t=r.getDefaultSiteCollectionTermStore();n.load(r);n.load(t);n.executeQueryAsync(y,b)}function y(){var u=SP.Guid.newGuid(),f=SP.Guid.newGuid(),e=SP.Guid.newGuid(),o=SP.Guid.newGuid(),s=SP.Guid.newGuid(),h=SP.Guid.newGuid(),c=t.createGroup("CustomTerms",u),r=c.createTermSet("Privacy",f,1033);r.createTerm("Top Secret",1033,e);r.createTerm("Company Confidential",1033,o);r.createTerm("Partners Only",1033,s);r.createTerm("Public",1033,h);i=t.get_groups();n.load(i);n.executeQueryAsync(p,w)}function p(){u()}function w(n,t){$("#report").children().remove();$("#report").append("Failed to add terms. Error: "+t.get_message())}function b(n,t){$("#report").children().remove();$("#report").append("Failed to get session. Error: "+t.get_message())}var n,f,e,r,t,i;$(document).ready(function(){n=SP.ClientContextPromise.get_current();e=n.get_site();f=n.get_web();$("#listExisting").click(function(){u()});$("#createTerms").click(function(){v()})})})(_||(_={}));
//# sourceMappingURL=App.min.js.map
